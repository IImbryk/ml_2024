## Домашнее задание 3

> Примечание: если ваш ответ не совпадает точно ни с одним из вариантов.  
> Выберите вариант, который ближе всего к вашему решению.

### Датасет

В этом домашнем задании мы будем использовать датасет Bank Marketing. Скачать его можно [здесь](https://archive.ics.uci.edu/static/public/222/bank+marketing.zip).

Или вы можете скачать его с помощью `wget`:

```bash
wget https://archive.ics.uci.edu/static/public/222/bank+marketing.zip
```

Нам нужно взять файл `bank/bank-full.csv` из загруженного архива.  
В этом датасете целевой переменной для задачи классификации будет переменная `y` — клиент подписал срочный депозит или нет.

### Признаки

Для оставшейся части домашнего задания вам нужно будет использовать только следующие столбцы:

* `age`,
* `job`,
* `marital`,
* `education`,
* `balance`,
* `housing`,
* `contact`,
* `day`,
* `month`,
* `duration`,
* `campaign`,
* `pdays`,
* `previous`,
* `poutcome`,
* `y`

### Подготовка данных

* Выберите только указанные выше признаки.
* Проверьте, есть ли пропущенные значения в этих признаках.

### Вопрос 1

Какое самое частое значение (mode) для столбца `education`?

- `unknown`
- `primary`
- `secondary`
- `tertiary`

### Вопрос 2

Создайте [корреляционную матрицу](https://www.google.com/search?q=correlation+matrix) для числовых признаков вашего датасета.  
В корреляционной матрице вычислите коэффициент корреляции между каждой парой признаков.

Какие два признака имеют наибольшую корреляцию?

- `age` и `balance`
- `day` и `campaign`
- `day` и `pdays`
- `pdays` и `previous`

### Кодирование целевой переменной

* Теперь нам нужно закодировать переменную `y`.
* Замените значения `yes`/`no` на `1`/`0`.

### Разделение данных

* Разделите данные на тренировочный/валидационный/тестовый наборы с распределением 60%/20%/20%.
* Используйте для этого Scikit-Learn (функцию `train_test_split`) и установите seed на `42`.
* Убедитесь, что целевая переменная `y` не включена в датафрейм.

### Вопрос 3

* Рассчитайте взаимную информацию между `y` и другими категориальными переменными в датасете. Используйте только тренировочный набор.
* Округлите результаты до двух знаков после запятой с помощью `round(score, 2)`.

Какая из этих переменных имеет наибольшую взаимную информацию?

* `contact`
* `education`
* `housing`
* `poutcome`

### Вопрос 4

* Теперь обучим логистическую регрессию.
* Не забывайте, что в датасете есть несколько категориальных переменных. Включите их с использованием one-hot кодирования.
* Обучите модель на тренировочном наборе данных.
    - Чтобы гарантировать воспроизводимость результатов в разных версиях Scikit-Learn, обучите модель с такими параметрами:
    - `model = LogisticRegression(solver='liblinear', C=1.0, max_iter=1000, random_state=42)`
* Рассчитайте точность на валидационном наборе данных и округлите ее до двух знаков после запятой.

Какую точность вы получили?

* 0.6
* 0.7
* 0.8
* 0.9

### Вопрос 5

* Давайте найдем наименее полезный признак, используя технику *feature elimination*.
* Обучите модель со всеми этими признаками (используя те же параметры, что и в Q4).
* Теперь исключите каждый признак по очереди и обучите модель без него. Запишите точность для каждой модели.
* Для каждого признака рассчитайте разницу между исходной точностью и точностью без этого признака.

Какой из следующих признаков имеет наименьшую разницу?

* `age`
* `balance`
* `marital`
* `previous`

> **Примечание**: Разница не обязательно должна быть положительной.

### Вопрос 6

* Теперь давайте обучим регуляризованную логистическую регрессию.
* Попробуем следующие значения параметра `C`: `[0, 0.01, 0.1, 1, 10]`.
* Обучите модели с использованием всех признаков, как в 4 вопросе.
* Рассчитайте точность на валидационном наборе данных и округлите ее до трех знаков после запятой.

Какое из значений `C` приводит к наилучшей точности на валидационном наборе?

* 0.01
* 0.1
* 1
* 10
* 100

> **Примечание**: Если есть несколько вариантов, выберите наименьшее `C`.
